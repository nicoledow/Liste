<% if @list %>
  <h1> <%= @list.title %>
<% else %>
  <h1> To do: </h1>
<% end %>


<h4> Let's get to work... </h4>

<%= form_for @task do |f| %>
  <%= f.text_field :description %> <br>
  
  <% if !@list %>
    <%= f.label :list_id %>
    <%= f.collection_select(:list_id, @lists, :id, :title) %> <br>
  <% else %>
    <%= f.hidden_field :list_id, value: @list.id%>
  <% end %>

  <%= f.submit "Add Task" %>
<% end %>

<ul>
  <% @tasks.each do |task| %>
    <li>
      <%= task.description %> <button> <%= link_to 'Details', task_path(task) %> </button>
      <% if current_user.manager? %>
        <% if !task.assigned? %>
          <%= form_for @assignment do |f| %>
            <%= f.collection_select(:user_id, @users, :id, :name)%>
            <%= f.text_field :due_date, value: "Due date"%>
            <%= f.hidden_field :task_id, value: task.id %>
            <%= f.submit "Assign Task" %>
          <% end %>
        <% end %>
      <% end %>
    </li>
  <% end %>
</ul>